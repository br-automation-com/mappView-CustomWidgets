
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="widgets_numeric_input.html">
      
      
        <link rel="next" href="widgets_transfer.html">
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.1">
    
    
      
        <title>Screenshot - mappView custom widgets</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.a40c8224.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="extra.css">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="orange" data-md-color-accent="orange">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#description" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="index.html" title="mappView custom widgets" class="md-header__button md-logo" aria-label="mappView custom widgets" data-md-component="logo">
      
  <img src="images/bur.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            mappView custom widgets
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Screenshot
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/br-automation-com/mappView-CustomWidgets" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub Repo
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="mappView custom widgets" class="md-nav__button md-logo" aria-label="mappView custom widgets" data-md-component="logo">
      
  <img src="images/bur.png" alt="logo">

    </a>
    mappView custom widgets
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/br-automation-com/mappView-CustomWidgets" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub Repo
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Start
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="installation.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="widgets_drop_down_box.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DropDownBox
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="widgets_numeric_input.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NumericInput
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Screenshot
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="widgets_screenshot.html" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Screenshot
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#description" class="md-nav__link">
    <span class="md-ellipsis">
      Description
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#windows-linux" class="md-nav__link">
    <span class="md-ellipsis">
      Windows / Linux
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#suppress-pop-up" class="md-nav__link">
    <span class="md-ellipsis">
      Suppress pop-up
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#br-panels" class="md-nav__link">
    <span class="md-ellipsis">
      B&amp;R Panels
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage" class="md-nav__link">
    <span class="md-ellipsis">
      Usage
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Usage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#additional-actions" class="md-nav__link">
    <span class="md-ellipsis">
      Additional Actions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#additional-events" class="md-nav__link">
    <span class="md-ellipsis">
      Additional Events
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#requirements" class="md-nav__link">
    <span class="md-ellipsis">
      Requirements
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#revision-history" class="md-nav__link">
    <span class="md-ellipsis">
      Revision History
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Revision History">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#version-6" class="md-nav__link">
    <span class="md-ellipsis">
      Version 6
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Version 6">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#version-5" class="md-nav__link">
    <span class="md-ellipsis">
      Version 5
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#version-4" class="md-nav__link">
    <span class="md-ellipsis">
      Version 4
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#version-3" class="md-nav__link">
    <span class="md-ellipsis">
      Version 3
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#version-2" class="md-nav__link">
    <span class="md-ellipsis">
      Version 2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#version-1" class="md-nav__link">
    <span class="md-ellipsis">
      Version 1
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="widgets_transfer.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transfer
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="widgets_toggle_switch.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ToggleSwitch
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="widgets_list_box.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ListBox
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="widgets_week_planning.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    WeekPlanning
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="widgets_week_planning_item.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    WeekPlanningItem
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="widgets_group_box.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GroupBox
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="revision.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Revision
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>Screenshot</h1>

<h2 id="description">Description</h2>
<p>This widgets creates a screenshot of the client visualization and stores it on the PLC or the client device. The widget is dervived from the button widget and therefore shares all its settings, actions and events. </p>
<h2 id="windows-linux">Windows / Linux</h2>
<p>Due to browser security restrictions the screen access is blocked for standard HTTP connections which is the default for mappView. mappView must be changed to HTTPS access or the HTTP URL must be added to the browser as an exception. Use the following line in the browser URL to access the flag</p>
<p><code>chrome://flags/#unsafely-treat-insecure-origin-as-secure</code></p>
<p><img alt="" src="images/screenshot2.png" /></p>
<p>Add the mappView URL and enable the flag.</p>
<p>When the screenshot is called it will open a window that will ask the user what to share. </p>
<p><img alt="" src="images/screenshot1.png" /></p>
<p>Select the tab or region for the screenshot and hit the Share button.</p>
<h2 id="suppress-pop-up">Suppress pop-up</h2>
<p>To avoid the additional pop you can use the browser switch "--auto-select-desktop-capture-source". In my test this only worked for Window Tab. Make sure you start the browser with URL and that only one tab is open. The switch needs the window name as parameter. For the screenshot below the complete switch would be "--auto-select-desktop-capture-source="Visualization visu"</p>
<p>Note that you might see the pop flash for a second before the screenshot is taken.</p>
<p><img alt="" src="images/screenshot4.png" /></p>
<h2 id="br-panels">B&amp;R Panels</h2>
<p>Due to browser security restrictions the screen access is blocked for standard HTTP connections which is the default for mappView. mappView must be changed to HTTPS access or the HTTP URL must be added to the browser as an exception. On B&amp;R panels the screen capture must be enabled in the panel settings. This option is available starting with firmware 1.6.x. In the web settings enable screen capture and optional suppress the security warning for the screen capture and server certificate.</p>
<p><img alt="" src="images/screenshot3.png" /></p>
<h2 id="usage">Usage</h2>
<p>This widget requires mapp File (see Automation Studio help GUID f5ac430b-e0ca-4320-bcd0-b7e28a087f77). Make sure that there is a valid mpfilemanager configuration. Only the configuration is required, no additional task or function block must be added to the project. The libraries <strong>MpFile</strong> and <strong>MpServer</strong> are also required.</p>
<h4 id="additional-actions">Additional Actions</h4>
<p>The widget derives all actions from the button widget.</p>
<p><strong>Screenshot2Client</strong>
This action creates a screenshot and saves it to the client device.</p>
<p><strong>Screenshot2Plc</strong>
This action creates a screenshot and saves it to the PLC. This action needs two parameters</p>
<ul>
<li>filePath - Full path to the screenshot image including the filename and extension. </li>
</ul>
<p>Example</p>
<p>USER/screenshot.png
USER is the storage medium specified in the target system configuration.</p>
<h4 id="additional-events">Additional Events</h4>
<p>The widget derives all events from the button widget.</p>
<p><strong>FileSaved</strong></p>
<p>This event is called when the Screenshot2Plc has saved the screenshot successful. Returns the full path of the file (filePath).</p>
<p><strong>FileDownloaded</strong></p>
<p>This event is called when the file was downloaded with Screenshot2Client successful. </p>
<p><strong>OnError</strong></p>
<p>This event is called when a screenshot was not successful. Returns the error number (result). Most error numbers are generated from underlying components and can be found in the Automation Studio help. The widget can also generate the following custom error numbers.</p>
<table>
<thead>
<tr>
<th>Error No</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>10000</td>
<td>Unknown error. Can occur when the user aborts the screenshot</td>
</tr>
<tr>
<td>10001</td>
<td>HTTP permission. This error occurs when the widget can not access the screen. Use HTTPS access or use flag as described above.</td>
</tr>
<tr>
<td>All other</td>
<td>All other error numbers come from the runtime and can be found in the Automation Studio help file</td>
</tr>
</tbody>
</table>
<p><strong>Typical issues</strong></p>
<ul>
<li>
<p>Error -1064165351: Cannot create file</p>
<p>Typical reasons for this error are
- The file device does not exist in the PLC configuration
- The path is not correct, folders do not exist
- The device is not configured in the mpfilemanager
- The permissions in the mpfilemanager configuration are not sufficient</p>
</li>
</ul>
<h2 id="requirements">Requirements</h2>
<p>Tested with</p>
<ul>
<li>Automation Studio 4.11</li>
<li>B&amp;R T-Panels firmware 1.6.x </li>
<li>Minimum tested version 5.15</li>
<li>Expected to work with later version</li>
</ul>
<p>May also work with lower version: <strong>YES</strong></p>
<h2 id="revision-history">Revision History</h2>
<h4 id="version-6">Version 6</h4>
<ul>
<li>Error 10000 now generates some additional details in the logger message</li>
</ul>
<h5 id="version-5">Version 5</h5>
<ul>
<li>Fixed save to PLC did not work on pre-cached pages</li>
</ul>
<h5 id="version-4">Version 4</h5>
<ul>
<li>Changed device name and file name to filePath to be compatible with other widgets </li>
<li>Removed obsolete code </li>
<li>Add error messages to PLC logger </li>
</ul>
<h5 id="version-3">Version 3</h5>
<ul>
<li>Widget is now compatible to B&amp;R T-Panels</li>
</ul>
<h5 id="version-2">Version 2</h5>
<ul>
<li>Optimized screenshot widget</li>
</ul>
<h5 id="version-1">Version 1</h5>
<ul>
<li>First release</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": ".", "features": "toc.integrate", "search": "assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="assets/javascripts/bundle.5090c770.min.js"></script>
      
    
  </body>
</html>